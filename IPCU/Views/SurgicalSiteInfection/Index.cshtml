@model IPCU.Models.SurgicalSiteInfectionChecklist

@{
    ViewData["Title"] = "SURGICAL SITE INFECTION (SSI) CHECKLIST";
}

<style>
    fieldset {
        border: 2px solid #000;
        padding: 10px;
        margin-bottom: 20px;
    }

    legend {
        font-weight: bold;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 10px;
    }

    td, th {
        border: 1px solid #000;
        padding: 5px;
        vertical-align: top;
    }

    label {
        font-weight: normal;
    }
</style>

<h2 style="text-align:center;">@ViewData["Title"]</h2>

<form asp-action="Submit" method="post">
    <fieldset>
        <legend>Patient Information</legend>
        <table>
            <tr>
                <td>
                    <label asp-for="Fname"></label><br />
                    <input asp-for="Fname" class="form-control" />
                    <span asp-validation-for="Fname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Mname"></label><br />
                    <input asp-for="Mname" class="form-control" />
                    <span asp-validation-for="Mname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Lname"></label><br />
                    <input asp-for="Lname" class="form-control" />
                    <span asp-validation-for="Lname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="HospitalNumber"></label><br />
                    <input asp-for="HospitalNumber" class="form-control" />
                    <span asp-validation-for="HospitalNumber" class="text-danger"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="DateOfBirth"></label><br />
                    <input asp-for="DateOfBirth" type="date" class="form-control" />
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Age"></label><br />
                    <input asp-for="Age" class="form-control" />
                    <span asp-validation-for="Age" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Gender"></label><br />
                    <select asp-for="Gender" class="form-control">
                        <option value="">--Select--</option>
                        <option>Male</option>
                        <option>Female</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Classification"></label><br />
                    <select asp-for="Classification" class="form-control">
                        <option value="">--Select--</option>
                        <option>Pay</option>
                        <option>Service</option>
                    </select>
                    <span asp-validation-for="Classification" class="text-danger"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="UnitWardArea"></label><br />
                    <input asp-for="UnitWardArea" class="form-control" />
                    <span asp-validation-for="UnitWardArea" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="MainService"></label><br />
                    <input asp-for="MainService" class="form-control" />
                    <span asp-validation-for="MainService" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="DateOfAdmission"></label><br />
                    <input asp-for="DateOfAdmission" type="date" class="form-control" />
                    <span asp-validation-for="DateOfAdmission" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="DateOfEvent"></label><br />
                    <input asp-for="DateOfEvent" type="date" class="form-control" />
                    <span asp-validation-for="DateOfEvent" class="text-danger"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="Investigator"></label><br />
                    <input asp-for="Investigator" class="form-control" />
                    <span asp-validation-for="Investigator" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="MDRO"></label><br />
                    <select asp-for="MDRO" class="form-control">
                        <option value="">--Select--</option>
                        <option>Yes</option>
                        <option>No</option>
                    </select>
                    <span asp-validation-for="MDRO" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Disposition"></label><br />
                    <select asp-for="Disposition" class="form-control" id="DispositionDropdown">
                        <option value="">--Select--</option>
                        <option>Mortality</option>
                        <option>Discharged</option>
                        <option>Still Admitted</option>
                        <option>Transferred In</option>
                        <option>Transferred Out</option>
                    </select>
                    <span asp-validation-for="Disposition" class="text-danger"></span>
                </td>
                <!-- Disposition Transfer input - initially hidden -->


                <td>
                    <label asp-for="DispositionDate"></label><br />
                    <input asp-for="DispositionDate" type="date" class="form-control" />
                    <span asp-validation-for="DispositionDate" class="text-danger"></span>
                </td>
            </tr>


            <td id="DispositionTransferRow" style="display:none;" colspan="2">
                <label asp-for="DispositionTransfer"></label><br />
                <input asp-for="DispositionTransfer" class="form-control" />
                <span asp-validation-for="DispositionTransfer" class="text-danger"></span>
            </td>

            <td colspan="2">
                <h4 style="margin-bottom:10px;">Type & Classification</h4>

                <input type="checkbox" id="SIPCheckbox" name="TypeClass" value="SIP" onchange="toggleSIP_SIS()" />
                <label for="SIPCheckbox">SIP</label>

                <input type="checkbox" id="SISCheckbox" name="TypeClass" value="SIS" onchange="toggleSIP_SIS()" />
                <label for="SISCheckbox">SIS</label>

                <input type="checkbox" id="DIPCheckbox" name="TypeClass" value="DIP" />
                <label for="DIPCheckbox">DIP</label>

                <input type="checkbox" id="DISCheckbox" name="TypeClass" value="DIS" />
                <label for="DISCheckbox">DIS</label>

                <input type="checkbox" id="OSCheckbox" name="TypeClass" value="OS" />
                <label for="OSCheckbox">O/S, specify:</label>
                <input type="text" id="OSSpecify" name="OSSpecify" style="margin-left: 5px;" />


                <input type="hidden" asp-for="TypeClass" id="TypeClassHidden" />
                <span asp-validation-for="TypeClass" class="text-danger"></span>
            </td>

            </tr>
        </table>
    </fieldset>

    <div id="SIP_SIS_Section" style="display: none;">
        <td colspan="2">
            <fieldset>
                <legend><strong>Superficial Incisional SSI (SIP, SIS)*</strong></legend>
                <table>
                    <tr>
                        <td colspan="2">
                            <strong>Date of event occurs <u>within 30 days</u></strong>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input asp-for="InvolvesOnlySkinAndSubcutaneousTissue" type="checkbox" />
                            <label asp-for="InvolvesOnlySkinAndSubcutaneousTissue">Involves only skin and subcutaneous tissue of the incision</label>
                        </td>
                    </tr>
                    <div id="additionalCriteria" style="display: none; margin-left: 20px;">
                    <tr>
                        <td colspan="2">
                            <strong>AND, at least one of the following:</strong>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input asp-for="PurulentDrainage" type="checkbox" />
                            <label asp-for="PurulentDrainage">Purulent drainage from the superficial incision</label>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input asp-for="OrganismsIdentified" type="checkbox" />
                            <label asp-for="OrganismsIdentified">Organisms identified from an aseptically-obtained specimen from the superficial incision or subcutaneous tissue by a culture or non-culture-based microbiologic testing method</label>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input asp-for="SuperficialIncisionOpened" type="checkbox" />
                            <label asp-for="SuperficialIncisionOpened">A superficial incision that is deliberately opened by a surgeon, physician, <strong>AND</strong></label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 20px;">
                            <input asp-for="NoCulturePerformed" type="checkbox" />
                            <label asp-for="NoCulturePerformed">Culture or non-culture-based testing of the superficial incision or subcutaneous tissue is not performed, <strong>AND</strong></label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 20px;">
                            <input asp-for="PatientHasSymptoms" type="checkbox" />
                            <label asp-for="PatientHasSymptoms">Patient has <strong>at least one</strong> of the following signs or symptoms:</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 40px;">
                            <input asp-for="LocalizedPainOrTenderness" type="checkbox" />
                            <label asp-for="LocalizedPainOrTenderness">Localized pain or tenderness</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 40px;">
                            <input asp-for="LocalizedSwelling" type="checkbox" />
                            <label asp-for="LocalizedSwelling">Localized swelling</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 40px;">
                            <input asp-for="Erythema" type="checkbox" />
                            <label asp-for="Erythema">Erythema</label>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-left: 40px;">
                            <input asp-for="Heat" type="checkbox" />
                            <label asp-for="Heat">Heat</label>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <input asp-for="DiagnosisByPhysician" type="checkbox" />
                            <label asp-for="DiagnosisByPhysician">Diagnosis of a superficial incisional SSI by a physician</label>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <em>
                                *Superficial incisional SSIs are monitored for a 30-day period for all procedure types; Secondary incisional SSIs are monitored for a 30-day period regardless of the surveillance period for the primary site.
                            </em>
                        </td>
                    </tr>
                    </div>
                  <div id="cultureSection" style="display: none; margin-top: 20px;">
                    <tr>
                        <td><strong>Culture date:</strong></td>
                        <td>
                            <input asp-for="CultureDate" type="date" class="form-control" />
                            <span asp-validation-for="CultureDate" class="text-danger"></span>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Culture results:</strong></td>
                        <td>
                            <textarea asp-for="CultureResults" class="form-control"></textarea>
                            <span asp-validation-for="CultureResults" class="text-danger"></span>
                        </td>
                    </tr>
                   </div>
                </table>
            </fieldset>
        </td>
    </div>


    <!-- Deep Incisional SSI (DIP, DIS) Section (Initially Hidden) -->
    <div id="DIP_DIS_Section" style="display: none;">
        <fieldset>
            <legend><strong>Deep Incisional SSI (DIP, DIS)</strong></legend>
            <table>
                <tr>
                    <td colspan="2"><strong>Date of event occurs <u>within 30 or 90 days</u></strong></td>
                </tr>
                <tr>
                    <td colspan="2"><strong>AND</strong></td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="InvolvesDeepSoftTissues" type="checkbox" />
                        <label asp-for="InvolvesDeepSoftTissues">Involves deep soft tissues of the incision (for example, fascial and muscle layers)</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2"><strong>AND, at least one of the following:</strong></td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="IDSTPurulentDrainage" type="checkbox" />
                        <label asp-for="IDSTPurulentDrainage">Purulent drainage from the deep incision</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="DeepIncisionOpenedOrDehisces" type="checkbox" />
                        <label asp-for="DeepIncisionOpenedOrDehisces">A deep incision that is deliberately opened or aspirated by a surgeon, physician, or spontaneously dehisces</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="IDSTSuperficialIncisionOpened" type="checkbox" />
                        <label asp-for="IDSTSuperficialIncisionOpened">A superficial incision that is deliberately opened by a surgeon, physician, <strong>AND</strong></label>
                    </td>
                </tr>
                <tr>
                    <td style="padding-left: 20px;">
                        <input asp-for="IDSTOrganismsIdentified" type="checkbox" />
                        <label asp-for="IDSTOrganismsIdentified">
                            Organism(s) identified from the deep soft tissues of the incision by a culture or nonculture-based microbiologic testing,
                            or culture or non-culture-based microbiologic testing method is not performed.
                            A culture or non-culture base test from the deep soft tissues of the incision that has a negative finding does not meet this criterion, <strong>AND</strong>
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="IDSTPatientHasSymptoms" type="checkbox" />
                        <label asp-for="IDSTPatientHasSymptoms"><strong>Patient has at least one</strong> of the following signs or symptoms:</label>
                    </td>
                </tr>
                <tr>
                    <td style="padding-left: 40px;">
                        <input asp-for="Fever" type="checkbox" />
                        <label asp-for="Fever">Fever (>38°C)</label>
                    </td>
                </tr>
                <tr>
                    <td style="padding-left: 40px;">
                        <input asp-for="IDSTLocalizedPainOrTenderness" type="checkbox" />
                        <label asp-for="IDSTLocalizedPainOrTenderness">Localized pain or tenderness</label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input asp-for="AbscessOrEvidenceOfInfection" type="checkbox" />
                        <label asp-for="AbscessOrEvidenceOfInfection">An abscess or other evidence of infection involving the deep incision detected on gross anatomical exam, histopathologic exam, or imaging test</label>
                    </td>
                </tr>
                <tr>
                    <td><strong>Culture date:</strong></td>
                    <td>
                        <input asp-for="IDSTCultureDate" type="date" class="form-control" />
                        <span asp-validation-for="IDSTCultureDate" class="text-danger"></span>
                    </td>
                </tr>
                <tr>
                    <td><strong>Culture results:</strong></td>
                    <td>
                        <textarea asp-for="IDSTCultureResults" class="form-control"></textarea>
                        <span asp-validation-for="IDSTCultureResults" class="text-danger"></span>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>

    <div id="OSSection" style="display: none;">
        <fieldset style="border: 2px solid black; padding: 10px; width: 100%;">
            <legend style="font-weight: bold; background-color: black; color: white; padding: 5px;">Organ/Space SSI (O/S)</legend>

            <table style="width: 100%; border-collapse: collapse; border: 1px solid black;">
                <tr>
                    <td colspan="2" style="border-bottom: 1px solid black; padding: 5px;">
                        <strong>Date of event occurs <u>within 30 or 90 days</u></strong>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="border-bottom: 1px solid black; padding: 5px;"><strong>AND</strong></td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 5px;">
                        <input asp-for="InvolvesDeeperThanFascialOrMuscleLayers" type="checkbox" />
                        <label asp-for="InvolvesDeeperThanFascialOrMuscleLayers">
                            Involves any part of the anatomy deeper than the fascial or muscle layers that was opened or manipulated during surgery
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="border-bottom: 1px solid black; padding: 5px;"><strong>AND, at least one of the following:</strong></td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 5px;">
                        <input asp-for="OSPurulentDrainage" type="checkbox" />
                        <label asp-for="OSPurulentDrainage">
                            Purulent drainage from a drain placed in the organ/space (e.g., closed suction drainage system, open drain, T-tube drain, CT-guided drainage)
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 5px;">
                        <input asp-for="OSOrganismsIdentified" type="checkbox" />
                        <label asp-for="OSOrganismsIdentified">
                            Organisms identified from fluid or tissue in the organ/space by a culture or non-culture based microbiologic testing method
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 5px;">
                        <input asp-for="OSAbscessOrEvidenceOfInfection" type="checkbox" />
                        <label asp-for="OSAbscessOrEvidenceOfInfection">
                            An abscess or other evidence of infection involving the organ/space detected on gross anatomical exam, histopathologic exam, or imaging test
                        </label>
                    </td>
                </tr>
                <tr>
                    <td colspan="2" style="border-bottom: 1px solid black; padding: 5px;"><strong>AND</strong></td>
                </tr>
                <tr>
                    <td colspan="2" style="padding: 5px;">
                        <input asp-for="MeetsSpecificOrganSpaceInfectionCriteria" type="checkbox" />
                        <label asp-for="MeetsSpecificOrganSpaceInfectionCriteria">
                            Meets at least one criterion for a specific organ/space infection site (see back for details)
                        </label>
                    </td>
                </tr>
                <tr>
                    <td style="border-top: 1px solid black; padding: 5px;"><strong>Culture date:</strong></td>
                    <td style="border-top: 1px solid black; padding: 5px;">
                        <input asp-for="OSCultureDate" type="date" class="form-control" />
                        <span asp-validation-for="OSCultureDate" class="text-danger"></span>
                    </td>
                </tr>
                <tr>
                    <td style="border-bottom: 1px solid black; padding: 5px;"><strong>Culture results:</strong></td>
                    <td style="border-bottom: 1px solid black; padding: 5px;">
                        <textarea asp-for="OSCultureResults" class="form-control"></textarea>
                        <span asp-validation-for="OSCultureResults" class="text-danger"></span>
                    </td>
                </tr>
            </table>
        </fieldset>
    </div>
</form>
<script>



    function toggleSIP_SIS() {
        var sipChecked = document.getElementById("SIPCheckbox").checked;
        var sisChecked = document.getElementById("SISCheckbox").checked;
        var section = document.getElementById("SIP_SIS_Section");

        if (sipChecked || sisChecked) {
            section.style.display = "block";  // Show section
        } else {
            section.style.display = "none";  // Hide section
        }
    }

    // Ensure the function runs when checkboxes are clicked
    document.getElementById("SIPCheckbox").addEventListener("change", toggleSIP_SIS);
    document.getElementById("SISCheckbox").addEventListener("change", toggleSIP_SIS);


     document.addEventListener("DOMContentLoaded", function () {
        const dipCheckbox = document.getElementById("DIPCheckbox");
        const disCheckbox = document.getElementById("DISCheckbox");
        const dipDisSection = document.getElementById("DIP_DIS_Section");

        function toggleDipDisSection() {
            if (dipCheckbox.checked || disCheckbox.checked) {
                dipDisSection.style.display = "block";
            } else {
                dipDisSection.style.display = "none";
            }
        }

        // Add event listeners
        dipCheckbox.addEventListener("change", toggleDipDisSection);
        disCheckbox.addEventListener("change", toggleDipDisSection);
    });

     document.addEventListener('DOMContentLoaded', function () {
        var osCheckbox = document.getElementById('OSCheckbox');
        var osSection = document.getElementById('OSSection');

        // Function to toggle the visibility of OSSection
        function toggleOSSection() {
            osSection.style.display = osCheckbox.checked ? 'block' : 'none';
        }

        // Attach event listener to checkbox
        osCheckbox.addEventListener('change', toggleOSSection);

        // Initialize visibility on page load
        toggleOSSection();
    });


</script>