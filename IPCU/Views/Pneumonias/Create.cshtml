@model IPCU.Models.Pneumonia

@{
    ViewData["Title"] = "Create";
}

<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

<div class="border border-black bg-white rounded-md p-4 space-y-4">
    <!-- HEADER -->
    <div class="grid grid-cols-3 items-center border border-black">
        <!-- Left Logo -->
        <div class="flex justify-center p-2 border-r border-black">
            <img src="/images/nkti-left-logo.png" alt="Left Logo" class="h-20 w-auto" />
        </div>
        <!-- Center Text -->
        <div class="text-center space-y-1 py-2">
            <p class="text-sm font-bold uppercase">National Kidney and Transplant Institute</p>
            <p class="text-sm">East Avenue, Quezon City</p>
            <p class="text-sm font-bold uppercase pt-2">Infection Prevention and Control Unit</p>
            <p class="text-sm font-bold uppercase border-t border-black pt-1">PNEUMONIA(PNEU)CHECKLIST</p>
        </div>
        <!-- Right Logo -->
        <div class="flex justify-center p-2 border-l border-black">
            <img src="/images/nkti-right-logo.png" alt="Right Logo" class="h-20 w-auto" />
        </div>
    </div>
<hr />
<form asp-action="Create" method="post">
    <fieldset class="border p-3 mb-4">
        <legend class="w-auto px-2 font-weight-bold">Patient Information</legend>
        <table class="table table-bordered">
            <tr>
                <td>
                    <label asp-for="Fname"></label>
                    <input asp-for="Fname" class="form-control" />
                    <span asp-validation-for="Fname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Mname"></label>
                    <input asp-for="Mname" class="form-control" />
                    <span asp-validation-for="Mname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Lname"></label>
                    <input asp-for="Lname" class="form-control" />
                    <span asp-validation-for="Lname" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="HospitalNumber"></label>
                    <input asp-for="HospitalNumber" class="form-control" />
                    <span asp-validation-for="HospitalNumber" class="text-danger"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="DateOfBirth"></label>
                    <input asp-for="DateOfBirth" type="date" class="form-control" />
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Age"></label>
                    <input asp-for="Age" class="form-control" />
                    <span asp-validation-for="Age" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="UnitWardArea"></label>
                    <input asp-for="UnitWardArea" class="form-control" />
                    <span asp-validation-for="UnitWardArea" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="MainService"></label>
                    <input asp-for="MainService" class="form-control" />
                    <span asp-validation-for="MainService" class="text-danger"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <label asp-for="DateOfEvent"></label>
                    <input asp-for="DateOfEvent" type="date" class="form-control" />
                    <span asp-validation-for="DateOfEvent" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Investigator"></label>
                    <input asp-for="Investigator" class="form-control" />
                    <span asp-validation-for="Investigator" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="DateOfAdmission"></label>
                    <input asp-for="DateOfAdmission" type="date" class="form-control" />
                    <span asp-validation-for="DateOfAdmission" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Disposition"></label>
                    <select asp-for="Disposition" class="form-control" id="dispositionSelect">
                        <option value="">-- Select Disposition --</option>
                        <option>Mortality</option>
                        <option>Discharged</option>
                        <option>Still Admitted</option>
                        <option>Transferred In</option>
                        <option>Transferred Out</option>
                    </select>
                    <span asp-validation-for="Disposition" class="text-danger"></span>

                    <div id="dispositionTransferDiv" style="display:none; margin-top:10px;">
                        <label asp-for="DispositionTransfer"></label>
                        <input asp-for="DispositionTransfer" class="form-control" id="dispositionTransferInput" />
                        <span asp-validation-for="DispositionTransfer" class="text-danger"></span>
                    </div>
                </td>
                
            </tr>
            <tr>
               
                <td>
                    <label asp-for="DispositionDate"></label>
                    <input asp-for="DispositionDate" type="date" class="form-control" />
                    <span asp-validation-for="DispositionDate" class="text-danger"></span>
                </td>
              
                <td>
                    <label asp-for="Gender"></label>
                    <select asp-for="Gender" class="form-control">
                        <option value="">Select</option>
                        <option>Male</option>
                        <option>Female</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="Classification"></label>
                    <select asp-for="Classification" class="form-control">
                        <option value="">Select</option>
                        <option>Pay</option>
                        <option>Service</option>
                    </select>
                    <span asp-validation-for="Classification" class="text-danger"></span>
                </td>
                <td>
                    <label asp-for="MDRO"></label>
                    <select asp-for="MDRO" class="form-control" id="MDRODropdown">
                        <option value="">Select</option>
                        <option>Yes</option>
                        <option>No</option>
                    </select>
                    <span asp-validation-for="MDRO" class="text-danger"></span>

                    <div id="mdroOrganismContainer" class="mt-2 d-none">
                        <label asp-for="MDROOrganism"></label>
                        <input asp-for="MDROOrganism" class="form-control" id="MDROOrganism" />
                        <span asp-validation-for="MDROOrganism" class="text-danger"></span>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <label asp-for="TypeClass" class="control-label"></label>
                    <select asp-for="TypeClass" class="form-control" id="TypeClass">
                        <option value="">Select Option</option>
                        <option value="PNEU1">PNEU1</option>
                        <option value="PNEU2">PNEU2</option>
                        <option value="PNEU3">PNEU3</option>
                    </select>
                    <span asp-validation-for="TypeClass" class="text-danger"></span>
                </td>
                <td colspan="4">
                    <label asp-for="PNEU_Subclass" class="control-label"></label>
                    <select asp-for="PNEU_Subclass" class="form-control" id="PNEU_Subclass">
                        <option value="">Select Subclass</option>
                    </select>
                    <span asp-validation-for="PNEU_Subclass" class="text-danger"></span>
                </td>
            </tr>
            
        </table>
    </fieldset>

            <!-- Hidden Form Table -->
    <div id="pneu1_1_section" class="table-section" style="display: none; margin-top: 20px;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1 Details</th>
                </tr>
                <tr>
                    <th>
                        <strong>Any patient, any age group,</strong>
                        has one of the following found in <strong>two or more</strong> chest imaging test results
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- First Step -->
                <tr id="step1">
                    <td>
                        <label>
                            Either <strong>new and persistent OR progressive and persistent:</strong>
                        </label>
                        <div>
                            <label><input type="radio" asp-for="PersistentorProgressive1_1" value="Infiltrate"> Infiltrate</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_1" value="Consolidation"> Consolidation</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_1" value="Cavitation"> Cavitation</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_1" value="Pneumatoceles"> Pneumatoceles, ≤1 year old</label>
                        </div>
                        <span asp-validation-for="PersistentorProgressive1_1" class="text-danger"></span>
                    </td>
                </tr>

                <!-- Second Step (Initially Hidden) -->
                <tr id="step2" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input class="form-check-input requirement" asp-for="Fever1_1" />
                            <span>Fever (> 38.0°C)</span>
                        </div>
                        <div>
                            <input class="form-check-input requirement" asp-for="Leukopenia1_1" />
                            <span>Leukopenia (≤ 4,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input class="form-check-input requirement" asp-for="Leukocytosis1_1" />
                            <span>Leukocytosis (≥ 12,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input class="form-check-input requirement" asp-for="Adults70old1_1" />
                            <span>Adults ≥ 70 years old, altered mental status with no other recognized cause</span>
                        </div>
                    </td>
                </tr>

                <!-- Third Step (Initially Hidden) -->
                <tr id="step3" style="display: none;">
                    <td>
                        <label><strong>AND, at least two (2) of the following:</strong></label>
                        <div>
                            <input class="form-check-input final-requirement" asp-for="NewPurulentSputum1_1" />
                            <span>
                                New onset of purulent sputum or change
                                in character of sputum, or increased
                                respiratory secretions, or suctioning
                                requirements
                            </span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement" asp-for="WorseningCoughOrDyspnea1_1" />
                            <span>New onset or worsening cough, or dyspnea, or tachypnea</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement" asp-for="RalesOrBronchialBreathSounds1_1" />
                            <span>Rales or bronchial breath sounds</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement" asp-for="WorseningGasExchange1_1" />
                            <span>Worsening gas exchange, increased oxygen requirements, or ventilator demand</span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
  </div>


            <!-- PNEU1_2 Form -->
    <div id="pneu1_2_section" class="table-section" style="display: none; margin-top: 20px;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1 Details</th>
                </tr>
                <tr>
                    <th>
                        <strong>Alternative criteria,</strong> for infants
                        <strong>≤ 1 year old,</strong> has one of the following found in
                        <strong> two or more</strong> chest imaging test results
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- First Step -->
                <tr id="step1_2">
                    <td>
                        <label>
                            Either <strong>new and persistent OR progressive and persistent:</strong>
                        </label>
                        <div>
                            <label><input type="radio" asp-for="PersistentorProgressive1_2" value="Infiltrate"> Infiltrate</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_2" value="Consolidation"> Consolidation</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_2" value="Cavitation"> Cavitation</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_2" value="Pneumatoceles"> Pneumatoceles, ≤1 year old</label>
                        </div>
                        <span asp-validation-for="PersistentorProgressive1_2" class="text-danger"></span>
                    </td>
                </tr>

                <!-- Second Step (Initially Hidden) -->
                <tr id="step2_2" style="display: none;">
                    <td>
                        <label><strong>AND</strong></label>
                        <div>
                            <input class="form-check-input requirement_2" asp-for="WorseningGasExchange1_2" />
                            <span>Worsening gas exchange</span>
                        </div>
                    </td>
                </tr>

                <!-- Third Step (Initially Hidden) -->
                <tr id="step3_2" style="display: none;">
                    <td>
                        <label><strong>AND, at least three (3) of the following:</strong></label>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="TemperatureInstability1_2" />
                            <span>Temperature instability</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="LeukopeniaOrLeukocytosis1_2" />
                            <span>
                                Leukopenia (≤ 4000 WBC/mm³) or
                                leukocytosis (≥ 15,000 WBC/mm³) and left shift (≥ 10% band forms)
                            </span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="NewPurulentSputum1_2" />
                            <span>
                                New onset of purulent sputum or change
                                in character of sputum, or increased
                                respiratory secretions, or suctioning
                                requirements
                            </span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="ApneaOrTachypneaOrNasalFlaring1_2" />
                            <span>
                                Apnea, tachypnea, nasal flaring with
                                retraction of chest wall, or with grunting
                            </span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="WheezingRalesOrRhonchi1_2" />
                            <span>Wheezing, rales, or rhonchi</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="Cough1_2" />
                            <span>Cough</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_2" asp-for="BradycardiaOrTachycardia1_2" />
                            <span>Bradycardia (&lt;100) or tachycardia (&gt;170)</span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="pneu1_3_section" class="table-section" style="display: none;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1_3 Details</th>
                </tr>
                <tr>
                    <th>
                        <strong>Alternative criteria,</strong> for child <strong>>1 year old or ≤12 years old,</strong> has one of the following found in <strong>two or more</strong> chest imaging test results
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- First Step -->
                <tr id="step1_3">
                    <td>
                        <label>
                            Either <strong>new and persistent OR progressive and persistent:</strong>
                        </label>
                        <div>
                            <label><input type="radio" asp-for="PersistentorProgressive1_3" value="Infiltrate"> Infiltrate</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_3" value="Consolidation"> Consolidation</label><br>
                            <label><input type="radio" asp-for="PersistentorProgressive1_3" value="Cavitation"> Cavitation</label><br>
                        </div>
                        <span asp-validation-for="PersistentorProgressive1_3" class="text-danger"></span>
                    </td>
                </tr>

                <!-- Second Step (Initially Hidden) -->
                <tr id="step2_3" style="display: none;">
                    <td>
                        <div>
                            <label><strong>AND, at least three (3) of the following:</strong></label>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="Fever1_3" />
                            <span>Fever (> 38°C) or hypothermia (<36°C)</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="Leukopenia1_3" />
                            <span>Leukopenia (≤ 4000 WBC/mm3) or leukocytosis (≥ 15,000 WBC/mm3)</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="NewPurulentSputum1_3" />
                            <span>New onset of purulent sputum or change in character of sputum, or increased respiratory secretions, or suctioning requirements</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="NewWorseningCough1_3" />
                            <span>New onset or worsening cough, or dyspnea, or apnea, or tachypnea</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="RalesorBronchial1_3" />
                            <span>Rales or bronchial breath sounds</span>
                        </div>
                        <div>
                            <input class="form-check-input final-requirement_3" asp-for="WorseningGas1_3" />
                            <span>Worsening gas exchange, increased oxygen requirements, or ventilator demand</span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- PNEU2_1 Form -->
    <div id="pneu2_1_section" class="table-section" style="display: none; margin-top: 20px;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1 Details</th>
                </tr>
                <tr>
                    <th>For Pneumonia with Common Bacterial or Filamentous Fungal Pathogens</th>
                </tr>
            </thead>
            <tbody>
                <!-- Step 1 -->
                <tr id="step1_1_1">
                    <td>
                        <label>Either <strong>new and persistent OR progressive and persistent:</strong></label>
                        <div>
                            <label><input asp-for="PersistentorProgressive2_1" type="radio" value="Infiltrate"> Infiltrate</label><br>
                            <label><input asp-for="PersistentorProgressive2_1" type="radio" value="Consolidation"> Consolidation</label><br>
                            <label><input asp-for="PersistentorProgressive2_1" type="radio" value="Cavitation"> Cavitation</label><br>
                            <label><input asp-for="PersistentorProgressive2_1" type="radio" value="Pneumatoceles"> Pneumatoceles</label><br>
                        </div>
                    </td>
                </tr>

                <!-- Step 2 (Initially Hidden) -->
                <tr id="step2_1_1" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="Fever2_1" class="form-check-input requirement_3_1" type="checkbox">
                            <span>Fever (> 38.0°C)</span>
                        </div>
                        <div>
                            <input asp-for="Leukopenia12_1" class="form-check-input requirement_3_1" type="checkbox">
                            <span>Leukopenia (≤ 4,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input asp-for="Leukocytosis2_1" class="form-check-input requirement_3_1" type="checkbox">
                            <span>Leukocytosis (≥ 12,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input asp-for="Adults70old2_1" class="form-check-input requirement_3_1" type="checkbox">
                            <span>Adults ≥ 70 years old, altered mental status with no other recognized cause</span>
                        </div>
                    </td>
                </tr>

                <!-- Step 3 (Initially Hidden) -->
                <tr id="step3_1_1" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="NewPurulentSputum2_1" class="form-check-input final-requirement_3_1" type="checkbox">
                            <span>New onset of purulent sputum or change in character of sputum, or increased respiratory secretions, or suctioning requirements</span>
                        </div>
                        <div>
                            <input asp-for="WorseningCoughOrDyspnea2_1" class="form-check-input final-requirement_3_1" type="checkbox">
                            <span>New onset or worsening cough, dyspnea, or tachypnea</span>
                        </div>
                        <div>
                            <input asp-for="RalesOrBronchialBreathSounds2_1" class="form-check-input final-requirement_3_1" type="checkbox">
                            <span>Rales or bronchial breath sounds</span>
                        </div>
                        <div>
                            <input asp-for="WorseningGasExchange2_1" class="form-check-input final-requirement_3_1" type="checkbox">
                            <span>Worsening gas exchange or increased oxygen requirements, or ventilator demand</span>
                        </div>
                    </td>
                </tr>

                <!-- Step 4 (Initially Hidden) -->
                <tr id="step4_1_1" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="OrganismIdentifiedFromBlood_2_1" class="form-check-input" type="checkbox">
                            <span>Organism identified from blood</span>
                        </div>
                        <div>
                            <input asp-for="PositiveQuantitativeCultureLRT_2_1" class="form-check-input" type="checkbox">
                            <span>
                                Positive quantitative culture or corresponding semi-quantitative culture
                                result from minimally-contaminated LRT
                                specimen (specifically BAL, protected
                                specimen brushing, or endotracheal aspirate)
                            </span>
                        </div>
                        <div>
                            <input asp-for="BALCellsContainIntracellularBacteria_2_1" class="form-check-input" type="checkbox">
                            <span>
                                ≥5% BAL-obtained cells contain
                                intracellular bacteria on direct microscopic exam (for example: Gram’s stain)
                            </span>
                        </div>
                        <div>
                            <input asp-for="PositiveQuantitativeCultureLungTissue_2_1" class="form-check-input" type="checkbox">
                            <span>
                                Positive quantitative culture or corresponding semi-quantitative culture
                                result of lung tissue
                            </span>
                        </div>
                        <div>
                            <input asp-for="HistopathologicExam2_1" class="form-check-input" type="checkbox">
                            <span>Histopathologic exam shows at least one of the following evidences of pneumonia:</span>
                        </div>
                        <div style="margin-left: 20px;">
                            <input class="form-check-input" asp-for="AbscessFormationOrFoci_2_1" />
                            <span>
                                Abscess formation or foci of consolidation with intense PMN
                                accumulation in bronchioles and alveoli
                            </span>
                        </div>
                        <div style="margin-left: 20px;">
                            <input class="form-check-input" asp-for="EvidenceOfFungalInvasion_2_1" />
                            <span>
                                Evidence of lung parenchyma invasion
                                by fungal hyphae or pseudohyphae
                            </span>
                        </div>

                    </td>
                </tr>

                <!-- Culture Details -->
                <tr>
                    <td>
                        <span><strong>Culture date:</strong></span>
                        <input asp-for="CultureDate2_1" type="date" class="form-control" />
                        <span><strong>Culture results:</strong></span>
                        <input asp-for="CultureResults2_1" class="form-control" />
                    </td>
                </tr>
            </tbody>
        </table>
    </div>


    <div id="pneu2_2_section" class="table-section" style="display: none;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1 Details</th>
                </tr>
                <tr>
                    <th>
                        For Viral, Legionella, and other Bacterial Pneumonias with Definitive Laboratory Findings
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- Step 1 -->
                <tr id="step1_2_2">
                    <td>
                        <label>Either <strong>new and persistent OR progressive and persistent:</strong></label>
                        <div>
                            <label><input asp-for="PersistentorProgressive2_2" type="radio" value="Infiltrate"> Infiltrate</label><br>
                            <label><input asp-for="PersistentorProgressive2_2" type="radio" value="Consolidation"> Consolidation</label><br>
                            <label><input asp-for="PersistentorProgressive2_2" type="radio" value="Cavitation"> Cavitation</label><br>
                            <label><input asp-for="PersistentorProgressive2_2" type="radio" value="Pneumatoceles"> Pneumatoceles</label><br>
                        </div>
                    </td>
                </tr>

                <!-- Step 2 (Initially Hidden) -->
                <tr id="step2_2_2" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="Fever2_1" class="form-check-input requirement_2_2" type="checkbox">
                            <span>Fever (> 38.0°C)</span>
                        </div>
                        <div>
                            <input asp-for="Leukopenia12_1" class="form-check-input requirement_2_2" type="checkbox">
                            <span>Leukopenia (≤ 4,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input asp-for="Leukocytosis2_1" class="form-check-input requirement_2_2" type="checkbox">
                            <span>Leukocytosis (≥ 12,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input asp-for="Adults70old2_1" class="form-check-input requirement_2_2" type="checkbox">
                            <span>Adults ≥ 70 years old, altered mental status with no other recognized cause</span>
                        </div>
                    </td>
                </tr>

                <!-- Step 3 (Initially Hidden) -->
                <tr id="step3_2_2" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="NewPurulentSputum2_2" class="form-check-input final-requirement_2_2" type="checkbox">
                            <span>
                                New onset of purulent sputum or change
                                in character of sputum, or increased
                                respiratory secretions, or suctioning
                                requirements
                            </span>
                        </div>
                        <div>
                            <input asp-for="WorseningCoughOrDyspnea2_2" class="form-check-input final-requirement_2_2" type="checkbox">
                            <span>New onset or worsening cough, dyspnea, or tachypnea</span>
                        </div>
                        <div>
                            <input asp-for="RalesOrBronchialBreathSounds2_2" class="form-check-input final-requirement_2_2" type="checkbox">
                            <span>Rales or bronchial breath sounds</span>
                        </div>
                        <div>
                            <input asp-for="WorseningGasExchange2_2" class="form-check-input final-requirement_2_2" type="checkbox">
                            <span>Worsening gas exchange or increased oxygen requirements</span>
                        </div>
                    </td>
                </tr>

                <!-- Step 4 (Initially Hidden) -->
                <tr id="step4_2_2" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="VirusBordetellaLegionella2_2" class="form-check-input" type="checkbox">
                            <span>
                                Virus, Bordetella, Legionella, Chlamydia, or Mycoplasma identified from respiratory
                                secretions or tissue by a culture or non-culture based microbiologic testing method which is performed for purposes of clinical
                                diagnosis or treatment
                            </span>
                        </div>
                        <div>
                            <input asp-for="FourfoldrisePaired2_2" class="form-check-input" type="checkbox">
                            <span>Fourfold rise in paired sera (IgG) for pathogen</span>
                        </div>
                        <div>
                            <input asp-for="FourfoldriseLegionella2_2" class="form-check-input" type="checkbox">
                            <span>
                                Fourfold rise in Legionella pneumophila serogroup 1 antibody titer to ≥ 1:128 in
                                paired acute and convalescent sera by indirect IFA
                            </span>
                        </div>
                        <div>
                            <input asp-for="DetectionofLegionella2_2" class="form-check-input" type="checkbox">
                            <span>
                                Detection of Legionella pneumophila serogroup 1 antigens in urine by RIA or EIA
                            </span>
                        </div>
                    </td>
                </tr>

                <!-- Culture Details (Always Visible) -->
                <tr id="culture_details_2_2">
                    <td>
                        <span><strong>Culture date:</strong></span>
                        <input asp-for="CultureDate2_2" type="date" class="form-control" />
                        <span>Culture results:</span>
                        <input asp-for="CultureResults2_2" class="form-control" />
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div id="pneu3_section" class="table-section" style="display: none;">
        <table class="table table-bordered">
            <thead class="table-grey">
                <tr>
                    <th style="text-align: center; background-color: #f8f9fa;">PNU1 Details</th>
                </tr>
                <tr>
                    <th>
                        Specific Site Algorithms for Pneumonia inImmunocompromised Patients
                    </th>
                </tr>
            </thead>
            <tbody>
                <!-- Step 1 -->
                <tr>
                    <td>
                        <label>Either <strong>new and persistent OR progressive and persistent:</strong></label>
                        <div>
                            <label><input asp-for="PersistentorProgressive3" type="radio" value="Infiltrate"> Infiltrate</label><br>
                            <label><input asp-for="PersistentorProgressive3" type="radio" value="Consolidation"> Consolidation</label><br>
                            <label><input asp-for="PersistentorProgressive3" type="radio" value="Cavitation"> Cavitation</label><br>
                            <label><input asp-for="PersistentorProgressive3" type="radio" value="Pneumatoceles"> Pneumatoceles</label><br>
                        </div>
                    </td>
                </tr>
                <!-- Step 2 (Initially Hidden) -->
                <tr id="step2_3_3" style="display: none;">
                    <td>
                        <label><strong>AND, patient is immunocompromised*</strong></label>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="Fever3" type="checkbox">
                            <span>Fever (> 38.0°C)</span>
                        </div>
                        <div>
                            <input asp-for="Adults70old3" type="checkbox">
                            <span>
                                Adults ≥ 70 years old, alteredmental status with no other recognized cause 
                                New onset of purulent sputumor changein character of sputum, 
                                or increased respiratory secretions, or suctioning requirements
                            </span>
                        </div>
                        <div>
                            <input asp-for="NewPurulentSputum3" type="checkbox">
                            <span>New onset of purulent sputumor changein character of sputum, or increasedrespiratory secretions, or suctioningrequirements</span>
                        </div>
                        <div>
                            <input asp-for="WorseningCoughOrDyspnea3" type="checkbox">
                            <span>New onset or worsening cough, or dyspnea, or tachypnea</span>
                        </div>
                        <div>
                            <input asp-for="RalesOrBronchialBreathSounds3" type="checkbox">
                            <span>Rales or bronchial breath sounds</span>
                        </div>
                        <div>
                            <input asp-for="WorseningGasExchange3" type="checkbox">
                            <span>Worsening gas exchange, increasedoxygen requirements, or ventilator demand</span>
                        </div>
                        <div>
                            <input asp-for="Hemoptysis3" type="checkbox">
                            <span>Hemoptysis</span>
                        </div>
                        <div>
                            <input asp-for="PleuriticChestPain3" type="checkbox">
                            <span>Pleuritic chest pain</span>
                        </div>
                    </td>
                </tr>
                <!-- Step 3 (Initially Hidden) -->
                <tr id="step3_3_3" style="display: none;">
                    <td>
                        <label><strong>AND, at least one (1) of the following:</strong></label>
                        <div>
                            <input asp-for="IdentificationCandida3" type="checkbox">
                            <span>Fever (> 38.0°C)</span>
                        </div>
                        <div>
                            <input asp-for="EvidenceofFungi3" type="checkbox">
                            <span>Leukopenia (≤ 4,000 WBC/mm³)</span>
                        </div>
                        <!---->
                        <div>
                            <input asp-for="DirectMicroscopicExam3" type="checkbox">
                            <span>Leukocytosis (≥ 12,000 WBC/mm³)</span>
                        </div>
                        <div>
                            <input asp-for="PositiveCultureFungi3" type="checkbox">
                            <span>Adults ≥ 70 years old, altered mental status with no other recognized cause</span>
                        </div>
                        <div>
                            <input asp-for="NonCultureDiagnostic3" type="checkbox">
                            <span>Adults ≥ 70 years old, altered mental status with no other recognized cause</span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label><strong>OR,</strong>any of the following from:</label>
                        <div>
                            <input asp-for="LaboratoryCriteria3" type="checkbox">
                            <span>Laboratory criteria defined under PNU2</span>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label><strong>*Immunocompromised patients include only:</strong></label>
                        <ul>
                            <li>
                                Those with neutropenia defined as absoluteneutrophil count or total white bloodcell count (WBC <500 /mm3)
                            </li>
                            <li>Those with leukemia, lymphoma or whoareHIV positive with CD4 count <200</li>
                            <li>Those who have undergone splenectomy</li>
                            <li>Those who have a history of solidorganorhematopoietic stemcell transplant</li>
                            <li>Those on cytotoxic chemotherapy</li>
                            <li>Those on enteral or parenteral administeredsteroids (exclude inhaled and topical steroids) daily for >14 consecutive daysonthe date of event</li>

                        </ul>

                    </td>
                </tr>
            </tbody>
        </table>
    </div>


            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>
        </form>
 
<div>
    <a asp-action="Index">Back to List</a>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const subclassMapping = {
                "PNEU1": ["pneu1_1", "pneu1_2", "pneu1_3"],
                "PNEU2": ["pneu2_1", "pneu2_2"],
                "PNEU3": [] // No subclasses, show table directly
            };

            const typeClassSelect = document.getElementById("TypeClass");
            const subclassSelect = document.getElementById("PNEU_Subclass");

            // Function to hide all tables and clear their input fields
            function hideAllTables() {
                document.querySelectorAll(".table-section").forEach(table => {
                    table.style.display = "none";
                    clearTableInputs(table); // Clear input fields
                });
            }

            // Function to clear input fields in a table
            function clearTableInputs(table) {
                table.querySelectorAll("input, select, textarea").forEach(input => {
                    if (input.type === "checkbox" || input.type === "radio") {
                        input.checked = false;
                    } else {
                        input.value = "";
                    }
                });
            }

            // Function to reset subclass dropdown
            function resetSubclassDropdown() {
                subclassSelect.innerHTML = '<option value="">Select Subclass</option>';
                subclassSelect.disabled = true;
            }

            // Hide all tables initially
            hideAllTables();
            resetSubclassDropdown();

            // When TypeClass is changed
            typeClassSelect.addEventListener("change", function () {
                hideAllTables(); // Hide and clear currently visible tables
                resetSubclassDropdown(); // Reset subclass dropdown

                const selectedType = this.value;

                // If PNEU3 is selected, show its table immediately and hide the subclass dropdown
                if (selectedType === "PNEU3") {
                    subclassSelect.style.display = "none"; // Hide subclass dropdown
                    const table = document.getElementById("pneu3_section");
                    if (table) table.style.display = "table"; // Show PNEU3 table
                    return; // Stop further execution
                }

                // For other types, reset and show subclass dropdown if applicable
                subclassSelect.style.display = "block";
                if (selectedType && subclassMapping[selectedType].length > 0) {
                    subclassSelect.disabled = false;
                    subclassMapping[selectedType].forEach(subclass => {
                        const option = document.createElement("option");
                        option.value = subclass;
                        option.textContent = subclass.toUpperCase();
                        subclassSelect.appendChild(option);
                    });
                }
            });

            // When Subclass is changed
            subclassSelect.addEventListener("change", function () {
                hideAllTables(); // Hide and clear all tables before showing a new one
                const selectedSubclass = this.value;

                if (selectedSubclass) {
                    const table = document.getElementById(`${selectedSubclass}_section`);
                    if (table) {
                        table.style.display = table.tagName === "TABLE" ? "table" : "block"; // Correct display property
                    }
                }
            });
        });

    </script>

    <!--PARA SA DYNAMIC NG PNEU1_1-->

    <!-- jQuery for Dynamic Behavior -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        $(document).ready(function() {
            // Step 1: Show the second row when a radio button is selected
            $('input[name="PersistentorProgressive1_1"]').change(function() {
                $('#step2').fadeIn();
            });

            // Step 2: Show the third row when at least one checkbox is checked
            $('.requirement').change(function() {
                if ($('.requirement:checked').length > 0) {
                    $('#step3').fadeIn();
                } else {
                    $('#step3').fadeOut(); // Hide if no checkboxes are selected
                }
            });

            // Step 3: Ensure at least 2 checkboxes are checked in the last step
            $('.final-requirement').change(function() {
                if ($('.final-requirement:checked').length >= 2) {
                }
            });
        });
    </script>
    <!--pnu1_2-->
    <script>
        $(document).ready(function() {
            // Step 1: Show the second row when a radio button is selected
            $('input[name="PersistentorProgressive1_2"]').change(function() {
                $('#step2_2').fadeIn();
            });

            // Step 2: Show the third row when the requirement is met
            $('.requirement_2').change(function() {
                if ($('.requirement_2:checked').length > 0) {
                    $('#step3_2').fadeIn();
                } else {
                    $('#step3_2').fadeOut();
                }
            });

            // Step 3: Ensure at least 3 checkboxes are checked in the last step
            $('.final-requirement_2').change(function() {
                if ($('.final-requirement_2:checked').length >= 3) {
                }
            });
        });
    </script>

    <!--pnu1_3-->
    <script>
        $(document).ready(function() {
            // Step 1: Show the second row when a radio button is selected
            $('input[name="PersistentorProgressive1_3"]').change(function() {
                $('#step2_3').fadeIn();
            });

            // Step 2: Show the third row when at least 3 checkboxes are checked
            $('.final-requirement_3').change(function() {
                if ($('.final-requirement_3:checked').length >= 3) {
                    $('#step3_3').fadeIn();
                } else {
                    $('#step3_3').fadeOut();
                }
            });
        });
    </script>

    <script>
                $(document).ready(function () {
            // Step 1: Show Step 2 when a radio button is selected (PNEU2_1)
            $('input[name="PersistentorProgressive2_1"]').change(function () {
                $('#step2_1_1').fadeIn();
            });

            // Step 2: Show Step 3 when at least one checkbox (Step 2) is checked (PNEU2_1)
            $('.requirement_3_1').change(function () {
                if ($('.requirement_3_1:checked').length > 0) {
                    $('#step3_1_1').fadeIn();
                } else {
                    $('#step3_1_1').fadeOut();
                }
            });

            // Step 3: Show Step 4 when at least one checkbox (Step 3) is checked (PNEU2_1)
            $('.final-requirement_3_1').change(function () {
                if ($('.final-requirement_3_1:checked').length > 0) {
                    $('#step4_1_1').fadeIn();
                } else {
                    $('#step4_1_1').fadeOut();
                }
            });

            // Step 1: Show Step 2 when a radio button is selected (PNEU2_2)
            $('input[name="PersistentorProgressive2_2"]').change(function () {
                $('#step2_2_2').fadeIn();
            });

            // Step 2: Show Step 3 when at least one checkbox (Step 2) is checked (PNEU2_2)
            $('.requirement_2_2').change(function () {
                if ($('.requirement_2_2:checked').length > 0) {
                    $('#step3_2_2').fadeIn();
                } else {
                    $('#step3_2_2').fadeOut();
                }
            });

            // Step 3: Show Step 4 when at least one checkbox (Step 3) is checked (PNEU2_2)
            $('.final-requirement_2_2').change(function () {
                if ($('.final-requirement_2_2:checked').length > 0) {
                    $('#step4_2_2').fadeIn();
                } else {
                    $('#step4_2_2').fadeOut();
                }
            });
        });

    </script>
    <script>
        $(document).ready(function () {
            // Step 1: Show step 2 when a radio button is selected
            $('input[name="PersistentorProgressive3"]').change(function () {
                $('#step2_3_3').fadeIn();
            });

            // Step 2: Show step 3 when at least one checkbox is selected
            $('.requirement_3_3').change(function () {
                if ($('.requirement_3_3:checked').length > 0) {
                    $('#step3_3_3').fadeIn();
                    $('#step3_3_3').next('tr').fadeIn(); // Show the next row

                } else {
                    $('#step3_3_3').fadeOut();
                }
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $("#dispositionSelect").change(function () {
                var selectedValue = $(this).val();
                var transferDiv = $("#dispositionTransferDiv");
                var transferInput = $("#dispositionTransferInput");

                if (selectedValue === "Transferred In" || selectedValue === "Transferred Out") {
                    transferDiv.show();
                } else {
                    transferDiv.hide();
                    transferInput.val(""); // Clear input when hiding
                }
            });
        });
    </script>
    <script>
           $(document).ready(function () {
            function toggleMDROOrganismField() {
                var selectedValue = $('#MDRODropdown').val();
                if (selectedValue === "Yes") {
                    $('#mdroOrganismContainer').removeClass('d-none');
                } else {
                    $('#mdroOrganismContainer').addClass('d-none');
                    $('#MDROOrganism').val(''); // optional: clear value if hidden
                }
            }

            toggleMDROOrganismField();

            $('#MDRODropdown').change(function () {
                toggleMDROOrganismField();
            });
        });
    </script>
}