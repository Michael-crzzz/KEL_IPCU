@{
    ViewData["Title"] = "Home Page";
}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

<div class="container py-5 bg-white shadow rounded-4 border border-light">
    <div class="header-section d-flex align-items-center justify-content-center px-3 py-2 mb-4 gap-3 animate__animated animate__fadeInDown">
        <div class="logo-box">
            <img src="~/images/NKTI.png" alt="NKTI Left Logo" class="img-fluid logo-img">
        </div>

        <div class="text-center flex-grow-0 mx-5 mb-5">
            <h1 class="text-primary fw-bold mb-1">IPCU SYSTEM</h1>
            <p class="text-muted text-fade mb-1">Welcome to the IPCU System</p>
            <p class="text-muted text-fade">Streamlined Management of Employee Forms & Trainings</p>
            <p class="text-secondary small fst-italic">Empowering infection control through efficient digital workflows</p>
        </div>

        <div class="logo-box">
            <img src="~/images/nkti-right-logo-removebg-preview.png" alt="NKTI Right Logo" class="img-fluid logo-img">
        </div>
    </div>

    <div class="row g-4">
        @{
            var cards = new List<dynamic>();

            // Define card with its role requirements
            // ICN Patient Management - For ICN role
            if (User.IsInRole("ICN") || User.IsInRole("Admin"))
            {
                cards.Add(new
                {
                    Title = "ICN Patient Management",
                    Desc = "Track ICN patients.",
                    Icon = "fas fa-hospital-user",
                    Color = "indigo",
                    Buttons = new[]{
        ("View Patients", "ICNPatient", "Index", "indigo text-white"),
        }
                });
            }

            // Training Summary - For all users
            cards.Add(new
            {
                Title = "Training Summary",
                Desc = "Summarize assessment reports.",
                Icon = "fas fa-chalkboard-teacher",
                Color = "warning",
                Buttons = new[]{
        ("Summary", "Evaluation", "SummaryReport", "warning text-white"),
        ("Reports", "TrainingSummary", "Reports", "outline-warning")
        }
            });

            // Hand Hygiene - For all users
            cards.Add(new
            {
                Title = "Hand Hygiene",
                Desc = "Track hygiene compliance.",
                Icon = "fas fa-hands-wash",
                Color = "success",
                Buttons = new[]{
        ("Open Form", "HandHygieneForms", "Index", "success"),
        ("Summary", "HandHygieneForms", "MonthlySummary", "outline-success")
        }
            });

            // Fit Testing - For all users
            cards.Add(new
            {
                Title = "Fit Testing",
                Desc = "Fill or view Fit Testing forms.",
                Icon = "fas fa-mask-face",
                Color = "purple",
                Buttons = new[]{
        ("Open Form", "FitTestingForm", "Index", "purple text-white"),
        ("Reports", "FitTestingForm", "Reports", "outline-purple")
        }
            });

            // Role Management - Only for Admin
            if (User.IsInRole("Admin"))
            {
                cards.Add(new
                {
                    Title = "Role Management",
                    Desc = "Manage user roles and permissions.",
                    Icon = "fas fa-user-shield",
                    Color = "danger",
                    Buttons = new[]{
        ("Roles", "RoleManagement", "Index", "danger"),
        ("Users", "RoleManagement", "UserRoles", "outline-danger")
        }
                });
            }

            // User Area Management - Only for Admin
            if (User.IsInRole("Admin"))
            {
                cards.Add(new
                {
                    Title = "User Area Management",
                    Desc = "Assign user work areas.",
                    Icon = "fas fa-map-marker-alt",
                    Color = "teal",
                    Buttons = new[]{
        ("Manage Areas", "UserAreaManagement", "Index", "teal"),
        ("Batch Assign", "UserAreaManagement", "BatchAssignAreas", "outline-teal")
        }
                });
            }

            // Notice of Referrals - For ICN and Admin
            if (User.IsInRole("ICN") || User.IsInRole("Admin"))
            {
                cards.Add(new
                {
                    Title = "Notice of Referrals",
                    Desc = "View referrals notice.",
                    Icon = "fas fa-file-medical",
                    Color = "secondary",
                    Buttons = new[]{
        ("Index", "NoticeOfReferrals", "Index", "secondary text-white")
        }
                });
            }

            // Environmental - For all users (can be restricted if needed)
            cards.Add(new
            {
                Title = "Environmental",
                Desc = "Environmental.",
                Icon = "fas fa-clipboard-list",
                Color = "orange",
                Buttons = new[]{
        ("Create Forms", "Station", "Index", "orange text-white")
        }
            });
        }

        @foreach (var card in cards)
        {
            <div class="col-md-6 col-lg-4 animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                <div class="card h-100 shadow rounded-4 border-0 hover-card">
                    <div class="card-top bg-@card.Color">
                        <i class="@card.Icon fa-2x text-white"></i>
                    </div>
                    <div class="card-body text-center p-4">
                        <h5 class="fw-bold mb-2">@card.Title</h5>
                        <p class="text-muted small">@card.Desc</p>
                        <div class="d-grid gap-2 mt-3">
                            @foreach (var btn in card.Buttons)
                            {
                                var btnParts = btn.Item4.Split(' ');
                                var btnBase = "btn-" + btnParts[0];
                                var extraClass = btnParts.Length > 1 ? btnParts[1] : "";
                                <a asp-controller="@btn.Item2" asp-action="@btn.Item3" class="btn @btnBase @extraClass">@btn.Item1</a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- ICRA Card with proper role checks -->
        @if (User.IsInRole("Admin") || User.IsInRole("ICN") || User.IsInRole("Engineering"))
        {
            <div class="col-md-6 col-lg-4 animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
                <div class="card h-100 shadow rounded-4 border-0 hover-card">
                    <div class="card-top bg-info">
                        <i class="fas fa-tools fa-2x text-white"></i>
                    </div>
                    <div class="card-body text-center p-4">
                        <h5 class="fw-bold mb-2">ICRA Dashboard</h5>
                        <p class="text-muted small">Manage ICRA activities efficiently.</p>
                        <div class="d-grid gap-2 mt-3">
                            <a asp-controller="ICRAs" asp-action="Index" class="btn btn-info text-white">View ICRA</a>

                            @if (User.IsInRole("Admin") || User.IsInRole("ICN"))
                            {
                                <a asp-controller="ICRADashboard" asp-action="AdminICN" class="btn btn-info text-white">Admin/ICN Dashboard</a>
                            }

                            @if (User.IsInRole("Engineering"))
                            {
                                <a asp-controller="ICRADashboard" asp-action="Engineering" class="btn btn-info text-white">Engineering Dashboard</a>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<style>
    body {
        background: linear-gradient(to bottom right, rgba(248, 249, 250, 0.96), rgba(233, 236, 239, 0.96)), url('https://www.transparenttextures.com/patterns/pw-maze-white.png');
        background-repeat: repeat;
        background-size: auto;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .header-section {
        background: linear-gradient(to right, #f8f9fa, #e9ecef);
        border-radius: 1rem;
        box-shadow: 0 0.125rem 1rem rgba(0, 0, 0, 0.05);
        gap: 2rem;
        flex-wrap: wrap;
        padding: 1rem 3rem;
    }

    .main-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #0d6efd;
    }

    .subtitle {
        font-size: 1.125rem;
        color: #6c757d;
    }

    .logo-box {
        flex: 0 0 auto;
        max-width: 160px;
    }

    .logo-img {
        max-height: 150px;
        width: auto;
        height: auto;
    }

    .hover-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

        .hover-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

    .card-top {
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-top-left-radius: 1rem;
        border-top-right-radius: 1rem;
        transition: background-color 0.3s ease;
    }

    /* Hover color overrides */
    .card:hover .card-top.bg-primary {
        background-color: #0b5ed7 !important;
    }

    .card:hover .card-top.bg-success {
        background-color: #157347 !important;
    }

    .card:hover .card-top.bg-warning {
        background-color: #ffca2c !important;
    }

    .card:hover .card-top.bg-danger {
        background-color: #bb2d3b !important;
    }

    .card:hover .card-top.bg-purple {
        background-color: #5a32a3 !important;
    }

    .card:hover .card-top.bg-teal {
        background-color: #18a383 !important;
    }

    .card:hover .card-top.bg-indigo {
        background-color: #520dc2 !important;
    }

    .card:hover .card-top.bg-info {
        background-color: #0dcaf0 !important;
    }

    .card:hover .card-top.bg-secondary {
        background-color: #6c757d !important;
    }

    .card:hover .card-top.bg-orange {
        background-color: #e96b0c !important;
    }

    /* Custom colors */
    .bg-purple {
        background-color: #6f42c1;
    }

    .bg-teal {
        background-color: #20c997;
    }

    .bg-indigo {
        background-color: #6610f2;
    }

    .bg-orange {
        background-color: #fd7e14;
    }

    /* Outline buttons for custom colors */
    .btn-outline-purple {
        color: #6f42c1;
        border: 1px solid #6f42c1;
        background-color: transparent;
    }

        .btn-outline-purple:hover {
            background-color: #6f42c1;
            color: #fff;
        }

    .btn-outline-teal {
        color: #20c997;
        border: 1px solid #20c997;
        background-color: transparent;
    }

        .btn-outline-teal:hover {
            background-color: #20c997;
            color: #fff;
        }

    .btn-outline-indigo {
        color: #6610f2;
        border: 1px solid #6610f2;
        background-color: transparent;
    }

        .btn-outline-indigo:hover {
            background-color: #6610f2;
            color: #fff;
        }

    /* Custom solid buttons */
    .btn-purple {
        background-color: #6f42c1;
        color: #fff;
        border: none;
    }

        .btn-purple:hover {
            background-color: #5a32a3;
            color: #fff;
        }

    .btn-teal {
        background-color: #20c997;
        color: #fff;
        border: none;
    }

        .btn-teal:hover {
            background-color: #18a383;
            color: #fff;
        }

    .btn-indigo {
        background-color: #6610f2;
        color: #fff;
        border: none;
    }

        .btn-indigo:hover {
            background-color: #520dc2;
            color: #fff;
        }

    .btn-orange {
        background-color: #fd7e14;
        color: #fff;
        border: none;
    }

        .btn-orange:hover {
            background-color: #e96b0c;
            color: #fff;
        }

    .hover-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        animation: pulse-card 0.5s ease;
    }
</style>

